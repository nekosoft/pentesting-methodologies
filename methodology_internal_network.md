
Testing from the perspective of an attacker with internal network access. Active reconnaissance is performed, meaning the systems in-scope will be directly scanned by a pentester. It's important to understand the potential impact of scanning systems, so these conditions must be discussed during the scoping phase. [Link to Important to Note section]

The testing process is often an iterative one. Generally a tester will continually perform reconnaissance as new services and systems are uncovered. This can happen even after a system is potentially exploited. The time it takes for an assessment will also determine the most critical aspects to test.

The following is a general, high level approach. When testing to validate compliance to a certain standard, certification or regulation, then each relevant aspect will 

# Methodology: Internal Network
## Reconnaissance

Active reconnaissance is performed, meaning the in-scope subnetswill be directly scanned and interacted with.

- Subnets scan and enumeration to see all active systems and services are accessible
- Open Source Intelligence Gathering (OSINT)

## Identifying and enumerating accessible systems

- Port scanning for common UDP and TCP open ports
	- If a system can handle the traffic (discussed with the client), a full TCP port scan may be launched against a system
- Service and OS fingerprinting
	- Identify the Operating System (i.e. Microsoft Windows or Linux), including information such as version, service pack information if applicable, the system build
	- Identify running services on open ports
		- Includes what service is running, information about the service such as: version, banner information, third party modules
	- Open file shares
		- Review sensitive information or account credentials
- Within Active Directory
	- Enumeration providing information about users, systems, domain, and group policy of the organisation


## Identifying Vulnerabilities


Vulnerabilities include technical vulnerabilities, but can also include implementation issues (such as misconfiguration, incorrectly implemented authentication), organisation processes or policies that are missing or not adhered to, logic flaws and anything introducing a risk.

- Automated vulnerability assessment tools such as Tenable Nessus
	- Scans for out-of-date software, potential misconfigurations, missing patches and other common vulnerabilities
- Specific services may require specialised vulnerability scanning
- Manual testing of vulnerabilities
	- Automated scans will not always uncover everything
	- The previous identification and enumeration results, as well as OSINT information, will be used to gain understanding about custom developed protocols and services


## Internal Traffic techniques

- Traffic analysis, traffic broadcasted from the internal network
	- Especially vulnerable protocols can include HTTP, SMB, LDAP
- Attempt relay attacks to gain access


## Exploitation

Any discovered vulnerabilities will be verified and validated to remove false-positives. This gives a deeper understanding into what and how a system is affected, likelihood for exploitation, and what its impact is. 

There are some situations where a vulnerability may not be tested for exploitability, or may require co-ordination with the business to create a specific time or window of opportunity. These situations may include, but are not limited to:
- insufficient access required for exploitation
- specific conditions must be in place
- avoiding service disruption

High to Critical risk vulnerabilities will be tested, validated and reported to the business as they are found. Conditions for a high or critical are discussed during the scoping phase.


## Post-Exploitation

Determining the full-scope of compromise.
- Information gathering about accessible and connected systems
- Further enumeration, gaining additional access, and proving the business impact
- Seek out the most critical and sensitive systems for the business, including payment related, customer information and databases, and anything else identified as critical during scoping


# Important to Note

### Precautions and avoiding Availability issues

Testing of some services or systems could create availability issues, due to the amount of traffic or nature of an exploited vulnerability. In these cases, testing will be discussed with the business first. 

Generally when conducting a network pentest, Denial of Service (including Distributed Denial of Service) will not be performed. Using credentials of real employees needs to be discussed and agreed on with the business, as this may have other negative implications.

Some potential scenarios to minimise the impact include:
- testing in a Development or Staging environment
- testing within a certain window of time, including outside business hours
- credentials for access should be created specifically for the testers

 Support teams should be available, or a way to escalate an issue, in case there is an unprecedented disruption to service.


